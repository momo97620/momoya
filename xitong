#!/bin/bash

# 定义颜色
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
LIGHTBLUE='\033[1;34m'  # 亮蓝色
LIGHTCYAN='\033[1;36m'  # 亮青色
LIGHTGREEN='\033[1;32m' # 亮绿色
NC='\033[0m' # No Color

# 显示系统信息
show_system_info() {
    # 获取主机名和系统信息
    hostname=$(hostname)
    os_info=$(lsb_release -d | awk -F: '{print $2}' | xargs)
    kernel_version=$(uname -r)
    
    # 获取CPU信息
    cpu_info=$(lscpu | grep "Model name" | awk -F: '{print $2}' | xargs)
    cpu_arch=$(uname -m)
    cpu_cores=$(nproc)
    cpu_speed=$(lscpu | grep "CPU MHz" | awk -F: '{print $2}' | xargs)
    
    # 获取内存信息
    mem_total=$(free -m | grep Mem | awk '{print $2}')
    mem_used=$(free -m | grep Mem | awk '{print $3}')
    
    # 获取硬盘使用情况
    disk_total=$(df -h / | awk 'NR==2 {print $2}')
    disk_used=$(df -h / | awk 'NR==2 {print $3}')
    
    # 获取网络信息
    network_in=$(cat /proc/net/dev | grep eth0 | awk '{print $2}')
    network_out=$(cat /proc/net/dev | grep eth0 | awk '{print $10}')
    
    # 获取地理位置
    location=$(curl -s https://ipinfo.io | jq -r '.city, .region, .country')

    # 获取IPv6地址，排除掉回环地址 (::1)
    ipv6_address=$(ip -6 addr show | grep inet6 | grep -v "fe80" | grep -v "::1" | awk '{print $2}' | cut -d/ -f1 | head -n 1)

    # 获取IPv4地址
    ipv4_address=$(ip -4 addr show | grep inet | grep -v "127.0.0.1" | awk '{print $2}' | cut -d/ -f1 | head -n 1)
    
    # 获取系统运行时长（并避免浮点数运算错误）
    uptime_seconds=$(awk '{print $1}' /proc/uptime)
    uptime_seconds_int=$(printf "%.0f" $uptime_seconds)  # 将浮点数转换为整数
    uptime_days=$((uptime_seconds_int / 86400))
    uptime_hours=$(( (uptime_seconds_int % 86400) / 3600 ))

    # 获取防火墙状态并转换为中文
    firewall_status=$(ufw status | grep -o 'active' || echo 'inactive')
    if [[ $firewall_status == "active" ]]; then
        firewall_status="已启用"
    else
        firewall_status="未启用"
    fi

    # 输出系统信息，调整排版
    echo -e "${LIGHTCYAN}主机名:${NC} $hostname"
    echo -e "${LIGHTCYAN}系统版本:${NC} $os_info"
    echo -e "${LIGHTCYAN}内核版本:${NC} $kernel_version"
    echo -e "${LIGHTGREEN}CPU架构:${NC} $cpu_arch"
    echo -e "${LIGHTGREEN}CPU型号:${NC} $cpu_info"
    echo -e "${LIGHTGREEN}CPU核心数:${NC} $cpu_cores"
    echo -e "${LIGHTGREEN}CPU频率:${NC} $cpu_speed MHz"
    echo -e "${LIGHTGREEN}内存:${NC} $mem_used/$mem_total MB"
    echo -e "${LIGHTGREEN}硬盘使用:${NC} $disk_used/$disk_total"
    echo -e "${LIGHTGREEN}网络接收:${NC} $network_in KB"
    echo -e "${LIGHTGREEN}网络发送:${NC} $network_out KB"
    echo -e "${LIGHTGREEN}地理位置:${NC} $location"
    echo -e "${LIGHTGREEN}IPv6地址:${NC} $ipv6_address"
    echo -e "${LIGHTGREEN}IPv4地址:${NC} $ipv4_address"
    echo -e "${LIGHTGREEN}防火墙状态:${NC} $firewall_status"
    echo -e "${LIGHTGREEN}系统运行时长:${NC} ${uptime_days}天 ${uptime_hours}小时"
}

# 执行显示系统信息函数
show_system_info