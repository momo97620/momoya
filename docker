install_docker() {
    echo -e "${BLUE}正在安装Docker...${NC}"
    
    # 检查依赖
    check_dependencies

    # 根据不同系统选择安装方式
    case $OS in
        ubuntu|debian)
            # 安装 Docker
            curl -fsSL https://get.docker.com | bash -s docker && \
            
            # 安装 Docker Compose (v2)
            curl -fsSL https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose && \
            chmod +x /usr/local/bin/docker-compose

            # 安装 Docker Compose
            apt update && \
            apt install -y docker-compose
        
        ;;
        
        centos|rhel|fedora)
            # 添加 Docker 仓库
            yum-config-manager --add-repo https://download.docker.com/linux/$OS/docker-ce.repo
            
            # 安装 Docker
            yum install -y docker-ce docker-ce-cli containerd.io

            # 安装 Docker Compose (v2)
            curl -fsSL https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose && \
            chmod +x /usr/local/bin/docker-compose
            ;;
        
        *)
            echo -e "${RED}不支持的操作系统！${NC}"
            exit 1
            ;;
    esac

    # 启动并设置开机自启
    systemctl start docker
    systemctl enable docker
    
    # 检查 Docker 是否安装成功
    if docker --version &> /dev/null && docker-compose --version &> /dev/null; then
        echo -e "${GREEN}Docker和Docker Compose安装成功！${NC}"
    else
        echo -e "${RED}Docker或Docker Compose安装失败，请检查日志！${NC}"
    fi
    read -n 1 -s -r -p "按任意键返回主菜单..."
}
